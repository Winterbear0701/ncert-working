{% extends 'base_new.html' %}
{% load static %}

{% block title %}Create Unit Test - Admin{% endblock %}

{% block extra_css %}
<style>
    .form-card {
        animation: fadeIn 0.5s ease-out;
    }
    @keyframes fadeIn {
        from { opacity: 0; transform: translateY(20px); }
        to { opacity: 1; transform: translateY(0); }
    }
    .input-group {
        transition: all 0.2s ease;
    }
    .input-group:focus-within {
        transform: scale(1.02);
    }
    .question-card {
        transition: all 0.3s ease;
    }
    .question-card:hover {
        box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
    }
    .mark-badge {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        min-width: 50px;
        height: 32px;
        padding: 0 12px;
        font-weight: 600;
        border-radius: 6px;
    }
    .mark-1 { background: #E0F2FE; color: #0369A1; }
    .mark-2 { background: #DBEAFE; color: #1E40AF; }
    .mark-3 { background: #DDD6FE; color: #5B21B6; }
    .mark-5 { background: #FCE7F3; color: #9F1239; }
    .mark-other { background: #FEF3C7; color: #92400E; }
</style>
{% endblock %}

{% block content %}
<div class="min-h-screen bg-gradient-to-br from-gray-50 to-blue-50 py-8">
    <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
        
        <!-- Header -->
        <div class="mb-8">
            <div class="bg-white rounded-xl shadow-lg p-6 form-card">
                <div class="flex items-center justify-between">
                    <div>
                        <h1 class="text-4xl font-bold text-gray-900 mb-2">
                            <i class="fas fa-plus-circle text-blue-600 mr-2"></i>
                            Create Unit Test
                        </h1>
                        <p class="text-gray-600">Set up a new subjective/essay-type test with AI evaluation</p>
                    </div>
                    <a href="{% url 'superadmin:unit_test_list' %}" 
                       class="px-6 py-3 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-all flex items-center gap-2">
                        <i class="fas fa-arrow-left"></i>
                        <span class="font-semibold">Back</span>
                    </a>
                </div>
            </div>
        </div>

        <!-- Form Card -->
        <div class="bg-white rounded-xl shadow-lg p-8 form-card">
            <form method="POST" action="{% url 'superadmin:unit_test_create' %}" class="space-y-6">
                {% csrf_token %}

                <!-- Test Title -->
                <div class="input-group">
                    <label for="title" class="block text-sm font-semibold text-gray-700 mb-2">
                        <i class="fas fa-heading text-blue-500 mr-2"></i>
                        Test Title *
                    </label>
                    <input type="text" 
                           id="title" 
                           name="title" 
                           required
                           class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition"
                           placeholder="e.g., Chapter 5 - Motion and Time Unit Test">
                    <p class="text-xs text-gray-500 mt-1">Give your test a descriptive title</p>
                </div>

                <!-- Chapter Selection -->
                <div class="input-group">
                    <label for="chapters" class="block text-sm font-semibold text-gray-700 mb-2">
                        <i class="fas fa-book text-indigo-500 mr-2"></i>
                        Chapters * <span class="text-xs text-gray-500">(Hold Ctrl/Cmd to select multiple)</span>
                    </label>
                    <select id="chapters" 
                            name="chapters" 
                            multiple
                            required
                            size="8"
                            class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition">
                        {% for chapter in chapters %}
                        <option value="{{ chapter.id }}">{{ chapter.chapter_number }} - {{ chapter.chapter_name }}</option>
                        {% endfor %}
                    </select>
                    <p class="text-xs text-gray-500 mt-1">Select one or more chapters this test covers. Hold Ctrl (Windows/Linux) or Cmd (Mac) to select multiple chapters.</p>
                </div>

                <!-- Description -->
                <div class="input-group">
                    <label for="description" class="block text-sm font-semibold text-gray-700 mb-2">
                        <i class="fas fa-align-left text-purple-500 mr-2"></i>
                        Description (Optional)
                    </label>
                    <textarea id="description" 
                              name="description" 
                              rows="4"
                              class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition"
                              placeholder="Provide additional instructions or context for students..."></textarea>
                    <p class="text-xs text-gray-500 mt-1">Add any special instructions or details</p>
                </div>

                <!-- Grid for Marks, Duration, Passing -->
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                    <!-- Total Marks -->
                    <div class="input-group">
                        <label for="total_marks" class="block text-sm font-semibold text-gray-700 mb-2">
                            <i class="fas fa-star text-yellow-500 mr-2"></i>
                            Total Marks *
                        </label>
                        <input type="number" 
                               id="total_marks" 
                               name="total_marks" 
                               value="100"
                               min="1"
                               required
                               class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition">
                        <p class="text-xs text-gray-500 mt-1">Maximum marks</p>
                    </div>

                    <!-- Duration -->
                    <div class="input-group">
                        <label for="duration_minutes" class="block text-sm font-semibold text-gray-700 mb-2">
                            <i class="fas fa-clock text-orange-500 mr-2"></i>
                            Duration (min) *
                        </label>
                        <input type="number" 
                               id="duration_minutes" 
                               name="duration_minutes" 
                               value="60"
                               min="1"
                               required
                               class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition">
                        <p class="text-xs text-gray-500 mt-1">Test duration</p>
                    </div>

                    <!-- Passing Marks -->
                    <div class="input-group">
                        <label for="passing_marks" class="block text-sm font-semibold text-gray-700 mb-2">
                            <i class="fas fa-check-double text-green-500 mr-2"></i>
                            Passing Marks *
                        </label>
                        <input type="number" 
                               id="passing_marks" 
                               name="passing_marks" 
                               value="40"
                               min="1"
                               required
                               class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition">
                        <p class="text-xs text-gray-500 mt-1">Minimum to pass</p>
                    </div>
                </div>

                <!-- Active Status -->
                <div class="input-group">
                    <label class="flex items-center cursor-pointer">
                        <input type="checkbox" 
                               name="is_active" 
                               class="w-5 h-5 text-blue-600 border-gray-300 rounded focus:ring-blue-500">
                        <span class="ml-3 text-sm font-semibold text-gray-700">
                            <i class="fas fa-toggle-on text-green-500 mr-2"></i>
                            Make test active (visible to students)
                        </span>
                    </label>
                    <p class="text-xs text-gray-500 mt-1 ml-8">Uncheck to keep test in draft mode</p>
                </div>

                <!-- Info Alert -->
                <div class="bg-blue-50 border-l-4 border-blue-500 p-4 rounded-lg">
                    <div class="flex">
                        <div class="flex-shrink-0">
                            <i class="fas fa-info-circle text-blue-500 text-xl"></i>
                        </div>
                        <div class="ml-3">
                            <h3 class="text-sm font-semibold text-blue-800 mb-1">Next Steps</h3>
                            <p class="text-sm text-blue-700">
                                After creating the test, you'll be able to add questions manually or upload them from a document.
                            </p>
                        </div>
                    </div>
                </div>

                <!-- Action Buttons -->
                <div class="flex gap-4 pt-6 border-t border-gray-200">
                    <button type="submit" 
                            class="flex-1 px-8 py-4 bg-gradient-to-r from-blue-500 to-indigo-600 text-white rounded-lg hover:from-blue-600 hover:to-indigo-700 transition-all shadow-lg hover:shadow-xl font-semibold text-lg transform hover:scale-105">
                        <i class="fas fa-plus-circle mr-2"></i>
                        Create Test & Add Questions
                    </button>
                    <a href="{% url 'superadmin:unit_test_list' %}" 
                       class="px-8 py-4 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-all font-semibold text-lg">
                        <i class="fas fa-times mr-2"></i>
                        Cancel
                    </a>
                </div>
            </form>
        </div>

        <!-- Help Card -->
        <div class="mt-8 bg-gradient-to-r from-purple-50 to-pink-50 rounded-xl shadow-lg p-6 border border-purple-200">
            <h3 class="text-lg font-bold text-purple-900 mb-3">
                <i class="fas fa-lightbulb text-yellow-500 mr-2"></i>
                Tips for Creating Effective Tests
            </h3>
            <ul class="space-y-2 text-sm text-purple-800">
                <li class="flex items-start gap-2">
                    <i class="fas fa-check-circle text-green-500 mt-1"></i>
                    <span><strong>Clear Title:</strong> Use descriptive titles that indicate chapter and topic</span>
                </li>
                <li class="flex items-start gap-2">
                    <i class="fas fa-check-circle text-green-500 mt-1"></i>
                    <span><strong>Appropriate Duration:</strong> 1-2 minutes per mark is a good guideline</span>
                </li>
                <li class="flex items-start gap-2">
                    <i class="fas fa-check-circle text-green-500 mt-1"></i>
                    <span><strong>Fair Passing Marks:</strong> 40-50% is typical for passing criteria</span>
                </li>
                <li class="flex items-start gap-2">
                    <i class="fas fa-check-circle text-green-500 mt-1"></i>
                    <span><strong>Draft Mode:</strong> Leave test inactive while adding/reviewing questions</span>
                </li>
            </ul>
        </div>

    </div>
</div>
{% endblock %}
